# NFS-e Unit Test Log

## Test Session: SaoPauloDriver (Initial Verification)
**Date**: 2025-12-18
**Component**: `App\Services\Fiscal\Drivers\SaoPauloDriver`
**Objective**: Verify that the XML generated by the driver adheres to the Paulistana Schema and that the Signature placeholder is correctly generated.

### Test Case: `test_it_generates_valid_xml_structure_for_sao_paulo`
**Input Data**:
```php
[
    'valor_servico' => 100.00,
    'tomador_cnpj' => '98.765.432/0001-99',
    'discriminacao' => 'Teste Unitario de XML'
]
```

**Expected Assertions**:
- [x] Contains `<p1:PedidoEnvioRPS>` (Root Namespace)
- [x] Contains `<CNPJ>12345678000190</CNPJ>` (Cleaned Provider CNPJ)
- [x] Contains `<ValorServicos>100.00</ValorServicos>` (Formatted Value)
- [x] Contains `<Assinatura>` tag.
- [x] Signature is NOT `SIGNATURE_PLACEHOLDER`.
- [x] Signature IS `MOCK-SIGNATURE-...` (Verification of fallback logic without cert).

### Execution Result
**Status**: ✅ PASS
**Assertions**: 6/6
**Duration**: ~16s
**Output**:
```
Tests:    1 passed (6 assertions)
Duration: 16.21s
```

## Test Session: SantosDriver (Initial Verification)
**Date**: 2025-12-18
**Component**: `App\Services\Fiscal\Drivers\SantosDriver`
**Objective**: Verify that the XML generated matches the Ginfes/ABRASF Schema.

### Test Case: `test_it_generates_valid_ginfes_xml_structure`
**Input Data**:
```php
[
    'valor_servico' => 200.50,
    'tomador_cnpj' => '98.765.432/0001-99',
    'discriminacao' => 'Servico em Santos'
]
```

**Expected Assertions**:
- [x] Contains `<EnviarLoteRpsEnvio>` (Ginfes Root)
- [x] Contains `xmlns="http://www.ginfes.com.br/..."`
- [x] Contains `<ValorServicos>200.50</ValorServicos>`
- [x] Contains `<CodigoMunicipio>3548500</CodigoMunicipio>` (Santos)

### Execution Result
**Status**: ✅ PASS
**Assertions**: 6/6
**Duration**: ~16s

